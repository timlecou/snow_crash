ls -la

Il y a un fichier:
-level12.pl

Je remarque une synthaxe dans le fichier perl, qui permet d'executer des commandes bash, les backticks.

Le script execute `egrep "^$xx" /tmp/xd 2>&1` et le stock dans une variable, je dois injecter une commande dans la variable $xx

Ce script prend un parametre puis l'injecte dans cette ligne de commande mais avant ca il le modifie, il effectue un translate pour uppercase toutes les lettres puis il supprime tous les whitespaces.

Pour que le parametre puisse etre interprete comme voulu il doit donc etre en majuscule.

Je cree un script dans un fichier OUI que je stock dans /tmp qui fait:

getflag > /tmp/foo

>vim OUI
>mv OUI /tmp
>chmod 777 OUI

Le script tourne sur un server expose sur le port 4646, je vais l'atteindre avec un curl.
Pour que le script execute mon fichier OUI je dois lui donner le chemin en parametre, et comme le script tranforme les minuscules en majuscules le chemin ne doit contenir que des majuscule.
J'utilise alors l'operateur ? de bash, permettant de substituer une lettre, mon chemin est `/???/OUI`, encode en URL ca donne %60%2F%3F%3F%3F%2FOUI%60

>curl -X GET 'localhost:4646/?x=%60%2F%3F%3F%3F%2FOUI%60'
>cat /tmp/foo
>
>Check flag.Here is your token : g1qKMiRpXf53AWhDaU7FEkczr
