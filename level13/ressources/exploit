ls -la

on a un binaire qui fait un check avec getuid au debut de l’execution et attend de voir l’UID 4242 pour donner le token

j’ai fait un fichier .c ou je redéfini la fonction getuid et la fait renvoyer 4242

je compile ce fichier en librairie partagée avec:


j’exporte ensuite la variable d’environnement LD_PRELOAD pour que ma lib passe avant la librairie standard dans l’execution avec:


enfin pour enlever le setuid du binaire je copie ce dernier

>chmod 777.
>gcc -fPIC -shared -o lib.so test.c
>export LD_PRELOAD="/home/user/level13/lib.so"
>cp level13 oui
>./oui
>your token is 2A31L79asukciNyi8uppkEuSx
