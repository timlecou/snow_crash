ls -la comme d'habitude

deux fichiers:
-level06: binaire
-level06.php

le fichier .php est lance lorsque l'on execute level06.

en ouvrant le fichier level06.phpje decouvre quelques lignes de php en bazar pas idente avec plein d'instrictions sur les memes lignes donc je le copie dans un autre fichiers ou j'ai les droits d'ecriture et norme le fichier.

Dans le fichier je remqrque une synthaxe que je ne connais pas : la fonction preg_replace avec un e a la fin de la regex, en me renseignant j'apprend que ca permet d'utiliser du code php dans la regex.
En cherchant encore un petit peu plus lon je decouvre qu'il sagit d'une fonctionnalite deprecated sur les nouvelles versions de php parce que ca permet une faille de securite.

Le premier appel a preg_replace va matcher le patterne suivant : [x <ARG>] et interpreter le code suivant s'il matche ce patterne : y("<ARG>")

J'ecris un fichier contenant le patterne et ajoute un appel a une fonction avec getflag en parametre
Je passe le fichier en premier argument et en deuxieme je passe 'shell_exec', fonction PHP qui execute une commande shell

>chmod 777 .
>echo '[x {$z(getflag)}]' > oui
>./level06 oui shell_exec
>
>Check flag x Here is your token : wiok45aaoguiboiki2tuin6ub
